<!-- Custom header layout with navbar branding and full menu -->
<header class="main-header">
    <div class="main-menu flex items-center w-full gap-2 p-1 pl-0">
        <!-- Custom navbar brand with avatar -->
        <a href="{{ "" | relLangURL }}" class="navbar-brand-custom" title="Back to home">
            {{ with .Site.Params.Author.image }}
            {{ $authorImage := "" }}
            {{ if or (strings.HasPrefix . "http:") (strings.HasPrefix . "https:") }}
            {{ $authorImage = resources.GetRemote . }}
            {{ else }}
            {{ $authorImage = resources.Get . }}
            {{ end }}
            {{ if $authorImage }}
            <img class="navbar-avatar-custom nozoom" src="{{ $authorImage.RelPermalink }}" alt="Big Cabbage" />
            {{ end }}
            {{ end }}
            <span class="navbar-title-custom">Big Cabbage</span>
        </a>

        <!-- Menu items and language switcher (right side) -->
        <div class="flex items-center ms-auto gap-4">
            <!-- Desktop Menu -->
            <div class="hidden md:flex">
                {{ partial "header/components/desktop-menu.html" . }}
            </div>

            <!-- Language Switcher -->
            <div class="flex items-center justify-center gap-1">
                {{ $page := . }}
                {{ $currentLang := .Lang }}
                {{ $langCount := len .Site.Languages }}
                {{ range $index, $lang := .Site.Languages }}
                {{ if eq $lang.Lang $currentLang }}
                <span
                    class="px-2 py-1 text-sm font-semibold rounded-md bg-primary-200 text-primary-600 dark:bg-primary-800 dark:text-primary-300">
                    {{ $lang.Params.displayName }}
                </span>
                {{ else }}
                {{ $translationList := where $page.Translations "Lang" $lang.Lang }}
                {{ if gt (len $translationList) 0 }}
                {{ $translation := index $translationList 0 }}
                <a href="{{ $translation.RelPermalink }}"
                    class="px-2 py-1 text-sm hover:font-semibold rounded-md hover:bg-primary-100 dark:hover:bg-primary-900 transition-colors">
                    {{ $lang.Params.displayName }}
                </a>
                {{ else }}
                {{ $homeTranslations := where $page.Site.Home.AllTranslations "Language.Lang" $lang.Lang }}
                {{ $homeLink := "/" }}
                {{ if gt (len $homeTranslations) 0 }}
                {{ $homeLink = (index $homeTranslations 0).RelPermalink }}
                {{ end }}
                <a href="{{ $homeLink }}"
                    class="px-2 py-1 text-sm hover:font-semibold rounded-md hover:bg-primary-100 dark:hover:bg-primary-900 transition-colors">
                    {{ $lang.Params.displayName }}
                </a>
                {{ end }}
                {{ end }}
                {{ if lt (add $index 1) $langCount }}
                <span class="text-gray-400 dark:text-gray-600">/</span>
                {{ end }}
                {{ end }}
            </div>

            <!-- Mobile Menu -->
            <div class="flex md:hidden">
                {{ partial "header/components/mobile-menu.html" . }}
            </div>
        </div>
    </div>

    {{ if .Site.Menus.subnavigation }}
    <div class="main-menu flex pb-3 flex-col items-end justify-between md:justify-start space-x-3">
        <div class="hidden md:flex items-center space-x-5">
            {{ range .Site.Menus.subnavigation }}
            <a href="{{ .URL }}" {{ if or (strings.HasPrefix .URL "http:" ) (strings.HasPrefix .URL "https:" ) }}
                target="_blank" {{ end }} class="flex items-center bf-icon-color-hover">
                {{ if .Pre }}
                <span {{ if and .Pre .Name }}class="mr-1" {{ end }}>
                    {{ partial "icon.html" .Pre }}
                </span>
                {{ end }}
                <span class="text-xs font-light" title="{{ .Title }}">
                    {{ .Name | markdownify }}
                </span>
            </a>
            {{ end }}
        </div>
    </div>
    {{ end }}

    {{ if .Site.Params.highlightCurrentMenuArea }}
    <script>
        (function () {
            var mainmenu = document.querySelector(".main-menu");
            if (!mainmenu) return;

            var path = window.location.pathname;
            var links = mainmenu.querySelectorAll('a[href="' + path + '"]');

            links.forEach(function (link) {
                var targets = link.querySelectorAll("span");
                targets.forEach(function (el) {
                    el.classList.add("active");
                });
            });
        })();
    </script>
    {{ end }}
</header>